import{_ as D,d as V,u as P,i as O,j as k,r as g,k as K,o as y,c as x,f as _,w as f,F as b,l as C,m as S,g as v,t as A,n as U,h as $}from"./entry-68dddcb2.mjs";var T={exports:{}},L={exports:{}};(function(c){function a(s,t,e,i){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(s,t,e,i)}a.prototype.run=function(s,t,e,i){this._init(s,t,e,i);for(var r=0;r<this._datasetLength;r++)if(this._visited[r]!==1){this._visited[r]=1;var n=this._regionQuery(r);if(n.length<this.minPts)this.noise.push(r);else{var o=this.clusters.length;this.clusters.push([]),this._addToCluster(r,o),this._expandCluster(o,n)}}return this.clusters},a.prototype._init=function(s,t,e,i){if(s){if(!(s instanceof Array))throw Error("Dataset must be of type array, "+typeof s+" given");this.dataset=s,this.clusters=[],this.noise=[],this._datasetLength=s.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}t&&(this.epsilon=t),e&&(this.minPts=e),i&&(this.distance=i)},a.prototype._expandCluster=function(s,t){for(var e=0;e<t.length;e++){var i=t[e];if(this._visited[i]!==1){this._visited[i]=1;var r=this._regionQuery(i);r.length>=this.minPts&&(t=this._mergeArrays(t,r))}this._assigned[i]!==1&&this._addToCluster(i,s)}},a.prototype._addToCluster=function(s,t){this.clusters[t].push(s),this._assigned[s]=1},a.prototype._regionQuery=function(s){for(var t=[],e=0;e<this._datasetLength;e++){var i=this.distance(this.dataset[s],this.dataset[e]);i<this.epsilon&&t.push(e)}return t},a.prototype._mergeArrays=function(s,t){for(var e=t.length,i=0;i<e;i++){var r=t[i];s.indexOf(r)<0&&s.push(r)}return s},a.prototype._euclideanDistance=function(s,t){for(var e=0,i=Math.min(s.length,t.length);i--;)e+=(s[i]-t[i])*(s[i]-t[i]);return Math.sqrt(e)},c.exports&&(c.exports=a)})(L);var F={exports:{}};(function(c){function a(s,t,e){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(s,t,e)}a.prototype.init=function(s,t,e){this.assignments=[],this.centroids=[],typeof s!="undefined"&&(this.dataset=s),typeof t!="undefined"&&(this.k=t),typeof e!="undefined"&&(this.distance=e)},a.prototype.run=function(s,t){this.init(s,t);for(var e=this.dataset.length,i=0;i<this.k;i++)this.centroids[i]=this.randomCentroid();for(var r=!0;r;){r=this.assign();for(var n=0;n<this.k;n++){for(var o=new Array(d),h=0,u=0;u<d;u++)o[u]=0;for(var p=0;p<e;p++){var d=this.dataset[p].length;if(n===this.assignments[p]){for(var u=0;u<d;u++)o[u]+=this.dataset[p][u];h++}}if(h>0){for(var u=0;u<d;u++)o[u]/=h;this.centroids[n]=o}else this.centroids[n]=this.randomCentroid(),r=!0}}return this.getClusters()},a.prototype.randomCentroid=function(){var s=this.dataset.length-1,t,e;do e=Math.round(Math.random()*s),t=this.dataset[e];while(this.centroids.indexOf(t)>=0);return t},a.prototype.assign=function(){for(var s=!1,t=this.dataset.length,e,i=0;i<t;i++)e=this.argmin(this.dataset[i],this.centroids,this.distance),e!=this.assignments[i]&&(this.assignments[i]=e,s=!0);return s},a.prototype.getClusters=function(){for(var s=new Array(this.k),t,e=0;e<this.assignments.length;e++)t=this.assignments[e],typeof s[t]=="undefined"&&(s[t]=[]),s[t].push(e);return s},a.prototype.argmin=function(s,t,e){for(var i=Number.MAX_VALUE,r=0,n=t.length,o,h=0;h<n;h++)o=e(s,t[h]),o<i&&(i=o,r=h);return r},a.prototype.distance=function(s,t){for(var e=0,i=Math.min(s.length,t.length);i--;){var r=s[i]-t[i];e+=r*r}return Math.sqrt(e)},c.exports&&(c.exports=a)})(F);var N={exports:{}},E={exports:{}};(function(c){function a(s,t,e){this._queue=[],this._priorities=[],this._sorting="desc",this._init(s,t,e)}a.prototype.insert=function(s,t){for(var e=this._queue.length,i=e;i--;){var r=this._priorities[i];this._sorting==="desc"?t>r&&(e=i):t<r&&(e=i)}this._insertAt(s,t,e)},a.prototype.remove=function(s){for(var t=this._queue.length;t--;){var e=this._queue[t];if(s===e){this._queue.splice(t,1),this._priorities.splice(t,1);break}}},a.prototype.forEach=function(s){this._queue.forEach(s)},a.prototype.getElements=function(){return this._queue},a.prototype.getElementPriority=function(s){return this._priorities[s]},a.prototype.getPriorities=function(){return this._priorities},a.prototype.getElementsWithPriorities=function(){for(var s=[],t=0,e=this._queue.length;t<e;t++)s.push([this._queue[t],this._priorities[t]]);return s},a.prototype._init=function(s,t,e){if(s&&t){if(this._queue=[],this._priorities=[],s.length!==t.length)throw new Error("Arrays must have the same length");for(var i=0;i<s.length;i++)this.insert(s[i],t[i])}e&&(this._sorting=e)},a.prototype._insertAt=function(s,t,e){this._queue.length===e?(this._queue.push(s),this._priorities.push(t)):(this._queue.splice(e,0,s),this._priorities.splice(e,0,t))},c.exports&&(c.exports=a)})(E);(function(c){if(c.exports)var a=E.exports;function s(t,e,i,r){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,i,r)}s.prototype.run=function(t,e,i,r){this._init(t,e,i,r);for(var n=0,o=this.dataset.length;n<o;n++)if(this._processed[n]!==1){this._processed[n]=1,this.clusters.push([n]);var h=this.clusters.length-1;this._orderedList.push(n);var u=new a(null,null,"asc"),p=this._regionQuery(n);this._distanceToCore(n)!==void 0&&(this._updateQueue(n,p,u),this._expandCluster(h,u))}return this.clusters},s.prototype.getReachabilityPlot=function(){for(var t=[],e=0,i=this._orderedList.length;e<i;e++){var r=this._orderedList[e],n=this._reachability[r];t.push([r,n])}return t},s.prototype._init=function(t,e,i,r){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),i&&(this.minPts=i),r&&(this.distance=r)},s.prototype._updateQueue=function(t,e,i){var r=this;this._coreDistance=this._distanceToCore(t),e.forEach(function(n){if(r._processed[n]===void 0){var o=r.distance(r.dataset[t],r.dataset[n]),h=Math.max(r._coreDistance,o);r._reachability[n]===void 0?(r._reachability[n]=h,i.insert(n,h)):h<r._reachability[n]&&(r._reachability[n]=h,i.remove(n),i.insert(n,h))}})},s.prototype._expandCluster=function(t,e){for(var i=e.getElements(),r=0,n=i.length;r<n;r++){var o=i[r];if(this._processed[o]===void 0){var h=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),this._distanceToCore(o)!==void 0&&(this._updateQueue(o,h,e),this._expandCluster(t,e))}}},s.prototype._distanceToCore=function(t){for(var e=this.epsilon,i=0;i<e;i++){var r=this._regionQuery(t,i);if(r.length>=this.minPts)return i}},s.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var i=[],r=0,n=this.dataset.length;r<n;r++)this.distance(this.dataset[t],this.dataset[r])<e&&i.push(r);return i},s.prototype._euclideanDistance=function(t,e){for(var i=0,r=Math.min(t.length,e.length);r--;)i+=(t[r]-e[r])*(t[r]-e[r]);return Math.sqrt(i)},c.exports&&(c.exports=s)})(N);(function(c){c.exports&&(c.exports={DBSCAN:L.exports,KMEANS:F.exports,OPTICS:N.exports,PriorityQueue:E.exports})})(T);const W=V({async setup(c,{expose:a}){a();let s,t;const e=P("spotify"),i=P("playlist"),r=([s,t]=O(()=>e.value.getAudioFeaturesForTracks(i.value.tracks.items.map(l=>l.track.id))),s=await s,t(),s),n=r.audio_features.map(l=>[l.instrumentalness,l.danceability,l.energy,l.speechiness,l.acousticness,l.valence]),o=k(2);console.log(r);const h=k();p(),console.log(h);function u(l){return[["\u{1F3BA}","instrumentalness",l.instrumentalness],["\u{1F483}","danceability",l.danceability],["\u26A1","energy",l.energy],["\u{1F3A4}","speechiness",l.speechiness],["\u{1F3B8}","acousticness",l.acousticness],["\u{1F917}","valence",l.valence]]}function p(){h.value=new T.exports.KMEANS().run(n,o.value).map(l=>l.map(m=>[i.value.tracks.items[m],r.audio_features[m]]))}const d={spotify:e,playlist:i,features:r,data:n,groupCount:o,clusters:h,getFeatureData:u,clusterTracks:p};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),X=v("h1",null,"Features",-1),z=v("label",null,"Number of groups",-1),G=$("Split"),H={class:"d-flex w-100"},J={class:"me-auto"},Y={class:"d-flex w-100"},Z={class:"me-auto"},j=["title"],R=v("circle",{r:"50%",cx:"50%",cy:"50%",fill:"var(--bs-secondary)"},null,-1),I=["stroke-dasharray"],tt={"dominant-baseline":"middle","text-anchor":"middle",x:"50%",y:"50%"};function et(c,a,s,t,e,i){const r=g("b-col"),n=g("b-row"),o=g("b-form-input"),h=g("b-button"),u=g("b-img"),p=g("b-list-group-item"),d=g("b-list-group"),l=K("b-tooltip");return y(),x(b,null,[_(n,null,{default:f(()=>[_(r,null,{default:f(()=>[X]),_:1})]),_:1}),_(n,null,{default:f(()=>[_(r,{cols:"3"},{default:f(()=>[z]),_:1}),_(r,{cols:"6"},{default:f(()=>[_(o,{modelValue:t.groupCount,"onUpdate:modelValue":a[0]||(a[0]=m=>t.groupCount=m),modelModifiers:{number:!0},type:"number"},null,8,["modelValue"])]),_:1}),_(r,{cols:"3"},{default:f(()=>[_(h,{onClick:t.clusterTracks,class:"w-100",variant:"primary"},{default:f(()=>[G]),_:1})]),_:1})]),_:1}),_(n,null,{default:f(()=>[(y(!0),x(b,null,C(t.clusters,m=>(y(),S(r,null,{default:f(()=>[_(d,null,{default:f(()=>[(y(!0),x(b,null,C(m,([w,Q])=>(y(),S(p,null,{default:f(()=>[_(n,null,{default:f(()=>[_(r,{cols:"auto"},{default:f(()=>[_(u,{fluid:"",src:w.track.album.images[0].url,width:"50",height:"50"},null,8,["src"])]),_:2},1024),_(r,null,{default:f(()=>[v("div",H,[v("h5",J,A(w.track.name),1)]),v("div",Y,[v("h6",Z,A(w.track.artists[0].name),1),(y(!0),x(b,null,C(t.getFeatureData(Q),([B,q,M])=>U((y(),x("svg",{title:`${q}: ${Math.round(M*100)}%`,class:"ms-1",height:"30",width:"30",viewBox:"0 0 40 40"},[R,v("circle",{r:"25%",cx:"-50%",cy:"50%",fill:"transparent",stroke:"var(--bs-primary)","stroke-width":"50%","stroke-dasharray":`calc(${M} * 62.8) 62.8`,transform:"rotate(-90)"},null,8,I),v("text",tt,A(B),1)],8,j)),[[l]])),256))])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024))),256))]),_:1})],64)}var it=D(W,[["render",et]]);export{it as default};
